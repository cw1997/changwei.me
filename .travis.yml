language: node_js
node_js:
  - '14'
services:
  - docker
sudo: required
#branches:
#  - master
#  - develop
cache:
  directories:
    - node_modules

before_install:
  - export TZ='Asia/Shanghai'  # set timezone
install:
  - npm install
before_script:
  - npm run build:all
script:
  - docker login -u changwei1997 -p DOCKER_HUB_PASSWORD
  - docker build . -t changwei1997/changwei.me:latest
  - docker push changwei1997/changwei.me:latest
after_success:
  echo "Build Success!"
#  - docker-compose -f docker-compose.yaml down
#  - docker-compose -f docker-compose.yaml up -d --force-recreate
